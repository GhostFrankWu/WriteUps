# dimensionality 15
>The more the merrier

# Explore
放到ida里，发现打印 **:)** 的条件是函数返回值为真
```cpp
bool __fastcall sub_1410(char *a1, __int64 a2, int a3)
{
  int v3; // er8
  __int64 v4; // rax
  int v5; // er9
  char v6; // al
  char *v7; // rcx
  int v8; // esi
  bool result; // al
  char v10; // r12

  v3 = dword_408C * dword_408C * dword_408C;
  if ( v3 > 0 )
  {
    v4 = 1LL;
    while ( 1 )
    {
      v5 = v4;
      if ( v3 == v4 )
        break;
      if ( *((_BYTE *)&unk_207F + ++v4) == 2 )
      {
        a3 = v5;
        break;
      }
    }
  }
  v6 = *a1;
  v7 = a1 + 1;
  v8 = dword_408C * dword_408C;
  if ( *a1 )
  {
    while ( 1 )
    {
      switch ( v6 )
      {
        case 'b':
          v8 = -(dword_408C * dword_408C);
          break;
        case 'd':
          v8 = dword_408C;
          break;
        case 'f':
          v8 = dword_408C * dword_408C;
          break;
        case 'l':
          v8 = -1;
          break;
        case 'r':
          v8 = 1;
          break;
        case 'u':
          v8 = -dword_408C;
          break;
        default:
          break;
      }
      a3 += v8;
      result = a3 < 0 || a3 > v3;
      if ( result )
        break;
      v10 = byte_2080[a3];
      if ( !v10 )
        return result;
      v6 = *v7++;
      if ( !v6 )
        goto LABEL_12;
    }
    result = 0;
  }
  else
  {
    v10 = byte_2080[a3];
LABEL_12:
    result = v10 == 3;
  }
  return result;
}
```
其中dword_408C就是指向byte_2080中元素（当前元素）的指针。  
其中六种case其实是三维数组中上下左右前后的移动指针的指令，导出数组发现只有0、1、2、3四种值，2和3都是唯一的，0很多，1很少，因此推测要求走三位迷宫，2到3或者3到2，0是障碍1是道路。  
写脚本遍历
```cpp
#include<iostream>

int m[11][11][11] = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
char prob[28] = { 32 };

void show() {
    for (int i = 0; i < 28; i++) {
        putchar(prob[i]);
    }
    putchar(10);
}

void go(int x, int y, int z, int p, int d) {
    if (d > 27) {
        return;
    }
    if (z < 10 && m[x][y][z + 1] && p != 1) {
        if (m[x][y][z + 1] == 3) {
            prob[d] = 'r';
            show();
        }
        prob[d] = 'r';
        go(x, y, z + 1, 0, d + 1);
    }
    if (z > 0 && m[x][y][z - 1] && p != 0) {
        if (m[x][y][z - 1] == 3) {
            prob[d] = 'l';
            show();
        }
        prob[d] = 'l';
        go(x, y, z - 1, 1, d + 1);
    }
    if (x < 10 && m[x + 1][y][z] && p != 3) {
        if (m[x + 1][y][z] == 3) {
            prob[d] = 'f';
            show();
        }
        prob[d] = 'f';
        go(x + 1, y, z, 2, d + 1);
    }
    if (x > 0 && m[x - 1][y][z] && p != 2) {
        if (m[x - 1][y][z] == 3) {
            prob[d] = 'b';
            show();
        }
        prob[d] = 'b';
        go(x - 1, y, z, 3, d + 1);

    }
    if (y < 10 && m[x][y + 1][z] && p != 5) {
        if (m[x][y + 1][z] == 3) {
            prob[d] = 'd';
            show();
        }
        prob[d] = 'd';
        go(x, y + 1, z, 4, d + 1);
    }
    if (y > 0 && m[x][y - 1][z] && p != 4) {
        if (m[x][y - 1][z] == 3) {
            prob[d] = 'u';
            show();
        }
        prob[d] = 'u';
        go(x, y - 1, z, 5, d + 1);
    }
}

int main() {
    for (int i = 0; i < 11; i++) {
        for (int j = 0; j < 11; j++) {
            for (int k = 0; k < 11; k++) {
                if (m[i][j][k] == 2) {
                    go(i, j, k, -1, 0);
                    return 0;
                }
            }
        }
    }
}
```
得到若干种可能的解，因为程序解密flag和输入有关，所以依此尝试可能的解：
>frrffllllffddffrrffuubbrrfff  
frrffllffllddffrrffuubbrrfff  
frrffllffddllffrrffuubbrrfff  
fllddllffrrffffrrffuubbrrfff  
flluulluuffffrrffrrddddrrfff  
fddllllffrrffffrrffuubbrrfff  

# Solve 
最终通过frrffllffddllffrrffuubbrrfff得到flag。